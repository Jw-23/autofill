// options/modules/i18n.js
import { VaultStorage } from './storage.js';

export const i18n = {
  zh: {
    debugLogs: "è°ƒè¯•æ—¥å¿—",
    addNewInfo: "æ·»åŠ æ–°ä¿¡æ¯",
    labelKeyname: "è‹±æ–‡é”®å",
    labelDesc: "è¯¦ç»†æè¿°",
    labelValue: "å¡«å†™å†…å®¹",
    saveBtn: "ä¿å­˜æ¡ç›®",
    savedInfo: "å·²ä¿å­˜çš„ä¿¡æ¯",
    noData: "æš‚æ— æ•°æ®",
    deleteBtn: "åˆ é™¤",
    alertMissing: "é”®åå’Œå†…å®¹å¿…å¡«",
    configAlert: "è¯·å…ˆåœ¨æ‰©å±•é€‰é¡¹ä¸­é…ç½®ä¸ªäººä¿¡æ¯ã€‚",
    editBtn: "ç¼–è¾‘",
    editTitle: "ç¼–è¾‘ä¿¡æ¯",
    cancelBtn: "å–æ¶ˆ",
    updateBtn: "æ›´æ–°",
    labelSecret: "é«˜æ•æ„Ÿæ•°æ® (éœ€äºŒæ¬¡ç¡®è®¤)",
    labelFakeValue: "å¹²æ‰°å†…å®¹ (éç™½åå•æ—¶ä½¿ç”¨)",
    whitelistTitle: "ä¿¡ä»»ç½‘ç«™ (ç™½åå•)",
    whitelistDesc: "åªæœ‰åœ¨è¿™äº›ç½‘ç«™ä¸­ï¼Œé«˜æ•æ„Ÿæ•°æ®æ‰ä¼šå¡«å†™çœŸå®å€¼ã€‚æ”¯æŒ * æ¨¡ç³ŠåŒ¹é…ã€‚",
    addBtn: "æ·»åŠ ",
    unlockTitle: "è§£é”ä»“åº“",
    unlockDesc: "è¾“å…¥ä¸»å¯†ç ä»¥è®¿é—®æ‚¨çš„æ•°æ®ã€‚",
    unlockBtn: "è§£é”",
    securityTitle: "å®‰å…¨è®¾ç½®",
    newMasterPass: "ä¸»å¯†ç ",
    confirmMasterPass: "ç¡®è®¤ä¸»å¯†ç ",
    enableEncryption: "å¯ç”¨åŠ å¯†",
    securityStatusOn: "çŠ¶æ€ï¼šå·²åŠ å¯† âœ…",
    securityStatusOff: "çŠ¶æ€ï¼šæœªåŠ å¯† ğŸ”“",
    closeBtn: "å…³é—­",
    passReq: "ä¸»å¯†ç ä¸èƒ½ä¸ºç©º",
    passMatchError: "ä¸¤æ¬¡è¾“å…¥çš„å¯†ç ä¸ä¸€è‡´",
    resetData: "é”€æ¯æ•°æ®å¹¶é‡ç½®",
    resetConfirm: "ç¡®å®šè¦é”€æ¯æ‰€æœ‰æ•°æ®å¹¶é‡ç½®å—ï¼Ÿæ­¤æ“ä½œæ— æ³•æ’¤é”€ï¼",
    enableConfirm: "ä¸€æ—¦å¯ç”¨ï¼Œæ¯æ¬¡å¡«å†™éƒ½éœ€è¾“å…¥å¯†ç ã€‚ç¡®å®šå—ï¼Ÿ",
    encDone: "åŠ å¯†å·²å¯ç”¨ï¼",
    oneByOne: "é€ä¸ªåŒ¹é…æ¨¡å¼",
    clusterMode: "é›†ç¾¤è¯†åˆ«æ¨¡å¼",
    dataManagement: "æ•°æ®ç®¡ç†",
    dataMgmtDesc: "å¤‡ä»½æˆ–æ¢å¤æ‚¨çš„ä¸ªäººä¿¡æ¯ã€‚å·²åŠ å¯†çš„æ•°æ®åœ¨å¯¼å‡ºå’Œå¯¼å…¥æ—¶ä»ä¿æŒåŠ å¯†çŠ¶æ€ã€‚",
    exportBtn: "å¯¼å‡ºæ•°æ®",
    importBtn: "å¯¼å…¥æ•°æ®",
    importSuccess: "å¯¼å…¥æ•°æ®æˆåŠŸï¼",
    exportFailed: "å¯¼å‡ºå¤±è´¥ï¼š",
    importFailed: "å¯¼å…¥å¤±è´¥ï¼š",
    importPassReq: "æ­¤å¤‡ä»½ä½¿ç”¨ä¸åŒçš„åŠ å¯†å¯†é’¥ã€‚è¯·è¾“å…¥è¯¥å¤‡ä»½å¯¼å‡ºæ—¶çš„ä»“åº“å¯†ç ï¼ˆä¸»å¯†ç ï¼‰ï¼š",
    unlockToImport: "ä»“åº“å½“å‰å·²é‡é”ï¼Œè¯·è¾“å…¥ä¸»å¯†ç è§£é”åè¿›è¡Œå¯¼å…¥ï¼š",
    invalidPass: "å¯†ç é”™è¯¯ï¼Œæ— æ³•è§£é”ã€‚",
    vaultMenu: "ä»“åº“",
    whitelistMenu: "ä¿¡ä»»ç½‘ç«™",
    dataMgmtMenu: "æ•°æ®ç®¡ç†",
    settingsMenu: "è®¾ç½®",
    settingsTitle: "è®¾ç½®",
    oneByOneDesc: "é€ä¸ªæ˜¾ç¤ºæ¨èé¡¹ï¼Œè€Œä¸æ˜¯ä¸€æ¬¡æ€§å…¨éƒ¨å¡«å……ã€‚",
    clusterModeDesc: "å¯ç”¨æ™ºèƒ½é›†ç¾¤è¯†åˆ«ç®—æ³•ï¼ˆBetaï¼‰ï¼ŒæŒ‰é¡µé¢ç»“æ„åˆ†ç»„è¯†åˆ«ã€‚",
    debugLogsDesc: "åœ¨æ§åˆ¶å°æ˜¾ç¤ºè¯¦ç»†çš„è¿è¡Œæ—¥å¿—ã€‚",
    securityDesc: "ä½¿ç”¨ä¸»å¯†ç åŠ å¯†æ‚¨çš„æ•æ„Ÿæ•°æ®ï¼Œç¡®ä¿å³ä½¿ä»–äººèƒ½è®¿é—®æµè§ˆå™¨å­˜å‚¨ä¹Ÿæ— æ³•ç›´æ¥æŸ¥çœ‹ã€‚",
    securityManageBtn: "å®‰å…¨é…ç½®",
    formatHelpTitle: "å¦‚ä½•å¯¼å…¥è‡ªå®šä¹‰ JSON æ–‡ä»¶ï¼Ÿ",
    formatPlainTitle: "æœªåŠ å¯† JSON æ ¼å¼ï¼š",
    formatDesc: "æ‚¨å¯ä»¥æ‰‹åŠ¨åˆ›å»ºæˆ–ç¼–è¾‘æœªåŠ å¯†çš„æ–‡ä»¶ä»¥ä¾¿æ‰¹é‡å¯¼å…¥ã€‚å¦‚æœå½“å‰ä»“åº“å·²å¯ç”¨åŠ å¯†ï¼Œå¯¼å…¥çš„æ˜æ–‡æ•°æ®å°†è¢«è‡ªåŠ¨åŠ å¯†ã€‚",
    aiLoadingTitle: "æ­£åœ¨åˆå§‹åŒ– AI æ¨¡å‹",
    aiLoadingDesc: "ç”±äº Gemini Nano æ¨¡å‹è¾ƒå¤§ (çº¦ 2-3GB)ï¼Œé¦–æ¬¡å¯ç”¨å¯èƒ½éœ€è¦ä¸‹è½½ã€‚è¯·ä¿æŒæµè§ˆå™¨å¼€å¯ã€‚",
    checkAI: "æ£€æŸ¥ AI ç°çŠ¶",
    aiReady: "AI æ¨¡å‹å·²å°±ç»ª âœ…",
    aiUnavailable: "AI ç›®å‰ä¸å¯ç”¨ (å¯èƒ½æ˜¯è®¾å¤‡ä¸æ”¯æŒæˆ–é…ç½®é”™è¯¯)",
    aiNotSupported: "æµè§ˆå™¨ç‰ˆæœ¬å¯èƒ½ä¸æ”¯æŒ Gemini Nanoï¼Œè¯·ç¡®ä¿ä½¿ç”¨ Chrome Canary æˆ– Dev (128+) å¹¶å¼€å¯ç›¸å…³ Flagã€‚",
    confirmBtn: "ç¡®å®š",
    AISettingTitle: "AI è®¾ç½®",
    aiProvider: "AI æ¨¡å‹æä¾›å•†",
    aiProviderLocal: "æœ¬åœ°æ¨¡å‹ (Gemini Nano, éšç§å®‰å…¨)",
    aiProviderRemote: "è¿œç¨‹ API (OpenAI ç­‰, éœ€é…ç½®)",
    aiRemoteDesc: "âš ï¸ éšç§æç¤ºï¼šä½¿ç”¨è¿œç¨‹ API æ—¶ï¼Œé¡µé¢è¾“å…¥æ¡†çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ä¼šè¢«å‘é€åˆ°ç¬¬ä¸‰æ–¹æœåŠ¡å™¨è¿›è¡Œåˆ†æï¼Œä½†æ‚¨çš„å¯†ç åº“æ•æ„Ÿå€¼ï¼ˆValueï¼‰**ç»ä¸ä¼š**è¢«å‘é€ã€‚ä»…å‘é€è¡¨å•æ ‡ç­¾å’Œæ‚¨åœ¨â€œä»“åº“â€ä¸­é…ç½®çš„â€œæè¿°(Description)â€å­—æ®µç”¨äºè¯­ä¹‰åŒ¹é…ã€‚",
    aiBaseUrl: "API åŸºç¡€ URL (Base URL)",
    aiKey: "API å¯†é’¥ (Key)",
    aiModel: "æ¨¡å‹åç§°",
    aiFetchModels: "è·å–æ¨¡å‹åˆ—è¡¨",
    saveAiSettings: "ä¿å­˜ AI è®¾ç½®",
    fetchError: "è·å–å¤±è´¥",
    fetchSuccess: "æˆåŠŸè·å–æ¨¡å‹",
    enterKeyUrl: "è¯·å…ˆå¡«å†™ URL å’Œ Key",
    smartAddBtn: "âœ¨ æ™ºèƒ½æ·»åŠ ",
    smartAddModalTitle: "AI æ™ºèƒ½æ·»åŠ ",
    smartAddDesc: "æè¿°æ‚¨æƒ³æ·»åŠ çš„æ•°æ®ï¼ˆä¾‹å¦‚â€œæ·»åŠ æˆ‘çš„æ”¶è´§åœ°å€...â€ï¼‰ã€‚AI å°†è‡ªåŠ¨ä¸ºæ‚¨ç»“æ„åŒ–æ•°æ®ã€‚",
    smartAddPlaceholder: "ä¾‹å¦‚ï¼šç”Ÿæˆä¸€ä¸ªåä¸º Alex çš„å¼€å‘äººå‘˜æ¡£æ¡ˆï¼Œå±…ä½åœ¨æ—§é‡‘å±±ï¼Œé‚®ç®±æ˜¯ alex@example.com...",
    smartAddGenerate: "ç”Ÿæˆ",
    smartAddPreviewTitle: "é¢„è§ˆç”Ÿæˆæ•°æ®",
    smartAddConfirm: "æ·»åŠ é€‰ä¸­é¡¹",
    smartAddGenerating: "æ­£åœ¨ç”Ÿæˆ...",
    smartAddError: "ç”Ÿæˆå¤±è´¥ï¼Œè¯·æ£€æŸ¥ API è®¾ç½®å¹¶ç¡®ä¿ä½¿ç”¨æ”¯æŒ JSON è¾“å‡ºçš„æ¨¡å‹ã€‚",
    smartAddNoResult: "æœªç”Ÿæˆæœ‰æ•ˆæ•°æ®ï¼Œè¯·å°è¯•æ›´è¯¦ç»†çš„æè¿°ã€‚"
  },
  en: {
    debugLogs: "Debug Logs",
    addNewInfo: "Add New Info",
    labelKeyname: "Keyname (e.g. phone_number)",
    labelDesc: "Description (Help AI match)",
    labelValue: "Value",
    saveBtn: "Add Entry",
    savedInfo: "Saved Information",
    noData: "No data saved.",
    deleteBtn: "Delete",
    alertMissing: "Keyname and Value are required",
    configAlert: "Please configure your personal information in the extension options first.",
    editBtn: "Edit",
    editTitle: "Edit Info",
    cancelBtn: "Cancel",
    updateBtn: "Update",
    labelSecret: "High Sensitivity (Confirm before fill, mask in list)",
    labelFakeValue: "Fake Value (Filled when site is not whitelisted)",
    whitelistTitle: "Trusted Websites (Whitelist)",
    whitelistDesc: "Real values for high-sensitivity data are only filled on these sites. Use * for wildcards (e.g. *.google.com).",
    addBtn: "Add",
    unlockTitle: "Unlock Vault",
    unlockDesc: "Enter master password to access your data.",
    unlockBtn: "Unlock",
    securityTitle: "Security Settings",
    newMasterPass: "Set New Master Password",
    confirmMasterPass: "Confirm Master Password",
    enableEncryption: "Enable Encryption",
    securityStatusOn: "Status: Encryption Enabled âœ…",
    securityStatusOff: "Status: Not Encrypted (Enable below) ğŸ”“",
    closeBtn: "Close",
    passReq: "Master password cannot be empty",
    passMatchError: "Passwords do not match",
    resetData: "Destroy All Data & Reset Security",
    resetConfirm: "Are you sure you want to destroy all data and reset all security settings? This action cannot be undone!",
    enableConfirm: "Once enabled, you will need your password to fill forms. Existing data will be encrypted. Continue?",
    encDone: "Encryption enabled!",
    oneByOne: "One-by-one Mode",
    clusterMode: "Smart Cluster Mode",
    dataManagement: "Data Management",
    dataMgmtDesc: "Backup or restore your personal information. Encrypted data remains protected during export/import.",
    exportBtn: "Export Data",
    importBtn: "Import Data",
    importSuccess: "Import successful!",
    exportFailed: "Export failed: ",
    importFailed: "Import failed: ",
    importPassReq: "This backup uses a different key. Please enter the master password used when this backup was created:",
    unlockToImport: "Vault is locked. Please enter master password to unlock and import:",
    invalidPass: "Invalid password, unable to unlock.",
    vaultMenu: "Vault",
    whitelistMenu: "Whitelist",
    dataMgmtMenu: "Data Management",
    settingsMenu: "Settings",
    settingsTitle: "Settings",
    oneByOneDesc: "Show suggestions one by one instead of filling all at once.",
    clusterModeDesc: "Identify groups of fields based on DOM structure (Beta).",
    debugLogsDesc: "Show detailed operation logs in the console.",
    securityDesc: "Encrypt your sensitive data with a master password to ensure privacy.",
    securityManageBtn: "Manage Security",
    formatHelpTitle: "How to import custom JSON?",
    formatPlainTitle: "Unencrypted JSON Format:",
    formatDesc: "You can manually create or edit unencrypted files for bulk import. If encryption is enabled, imported plain data will be automatically encrypted.",
    aiLoadingTitle: "Initializing AI Model",
    aiLoadingDesc: "Gemini Nano is a large model (~2GB) and may require a one-time download. Please keep the browser open.",
    checkAI: "Check AI Status",
    aiReady: "AI Model is Ready âœ…",
    aiUnavailable: "AI is currently unavailable (Device might not be supported)",
    aiNotSupported: "Gemini Nano is not supported in this browser version. Use Chrome Canary/Dev (128+) and enable AI Flags.",
    confirmBtn: "Confirm",
    AISettingTitle: "AI Settings",
    aiProvider: "AI Provider",
    aiProviderLocal: "Local (Gemini Nano, Private)",
    aiProviderRemote: "Remote API (OpenAI etc.)",
    aiRemoteDesc: "âš ï¸ Privacy Note: When using Remote API, form context is sent to the third-party server. However, your sensitive vault values are **NEVER** sent. Only form labels and your vault 'Descriptions' are sent for semantic matching.",
    aiBaseUrl: "API Base URL",
    aiKey: "API Key",
    aiModel: "Model Name",
    aiFetchModels: "Fetch Models",
    saveAiSettings: "Save AI Settings",
    fetchError: "Fetch Failed",
    fetchSuccess: "Successfully fetched models",
    enterKeyUrl: "Please enter URL and Key first",
    smartAddBtn: "âœ¨ Smart Add",
    smartAddModalTitle: "AI Smart Add",
    smartAddDesc: "Describe the data you want to add (e.g. 'Add my shipping address: ...'). AI will structure it for you.",
    smartAddPlaceholder: "E.g. Create a persona for a developer named Alex, living in SF, with email alex@example.com...",
    smartAddGenerate: "Generate",
    smartAddPreviewTitle: "Preview Generated Data",
    smartAddConfirm: "Add Selection",
    smartAddGenerating: "Generating...",
    smartAddError: "Generation failed. Please check API settings and ensure model supports JSON output.",
    smartAddNoResult: "No valid data generated. Try a more detailed description."
  }
};

export let currentLang = 'zh';

export async function updateLanguageUI(callback) {
  currentLang = await VaultStorage.getLanguage();
  document.querySelectorAll('[data-i18n]').forEach(el => {
    const key = el.getAttribute('data-i18n');
    if (i18n[currentLang][key]) {
      el.innerText = i18n[currentLang][key];
    }
  });
  
  // Also update placeholders
  const unlockPass = document.getElementById('unlock-pass');
  const promptInput = document.getElementById('prompt-input');
  if (currentLang === 'zh') {
    unlockPass?.setAttribute('placeholder', 'å¯†ç ');
    promptInput?.setAttribute('placeholder', 'è¾“å…¥å†…å®¹...');
  } else {
    unlockPass?.setAttribute('placeholder', 'Password');
    promptInput?.setAttribute('placeholder', 'Enter content...');
  }
  
  // Update security status texts manually as they are dynamic
  const isEnc = await VaultStorage.isEncryptionEnabled();
  const statusDisplay = document.getElementById('security-status-display');
  const statusModal = document.getElementById('security-status');
  const statusText = isEnc ? i18n[currentLang].securityStatusOn : i18n[currentLang].securityStatusOff;
  
  if (statusDisplay) statusDisplay.innerText = statusText;
  if (statusModal) statusModal.innerText = statusText;

  if (callback) callback();
}
